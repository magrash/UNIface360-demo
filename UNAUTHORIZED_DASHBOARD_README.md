# Unauthorized Area Dashboard Documentation

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©
Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª ÙÙŠ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù†ÙØ· ÙˆØ§Ù„ØºØ§Ø². ÙŠØªØ¶Ù…Ù† ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§ØªØŒ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§ØªØŒ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©ØŒ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±.

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
1. [Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©](#Ø§Ù„ØµÙØ­Ø©-Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
2. [Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª](#Ø³Ø¬Ù„-Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª)
3. [Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§](#Ø§Ù„Ù…Ù†Ø§Ø·Ù‚-ØºÙŠØ±-Ø§Ù„Ù…ØµØ±Ø­-Ø¨Ù‡Ø§)
4. [Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø´Ø®Øµ](#Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª-Ø­Ø³Ø¨-Ø§Ù„Ø´Ø®Øµ)
5. [Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…](#Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª-Ø­Ø³Ø¨-Ø§Ù„Ù‚Ø³Ù…)
6. [Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹](#Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª-Ø­Ø³Ø¨-Ø§Ù„Ù…ÙˆÙ‚Ø¹)
7. [ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±](#ØªØ­Ù„ÙŠÙ„-Ø§Ù„Ù…Ø®Ø§Ø·Ø±)
8. [Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ / Ø³Ø¬Ù„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª](#Ø§Ù„Ø³Ø¬Ù„-Ø§Ù„ÙŠÙˆÙ…ÙŠ--Ø³Ø¬Ù„-Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª)
9. [Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø«](#Ø§Ù„Ø¥Ø¨Ù„Ø§Øº-Ø¹Ù†-Ø§Ù„Ø­ÙˆØ§Ø¯Ø«)
10. [Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª ÙˆØ³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±](#Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª-ÙˆØ³Ø¨Ø¨-Ø§Ù„Ø¬Ø°Ø±)
11. [Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©](#Ø¥Ø¯Ø§Ø±Ø©-Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª-Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©)
12. [Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨](#Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª-Ø§Ù„ØªØ¯Ø±ÙŠØ¨)
13. [Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…](#Ù†Ù‚Ø§Ø·-Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…)
14. [Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„Ø§Ù…Ø©](#Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª-ÙˆÙ‚ÙˆØ§Ø¹Ø¯-Ø§Ù„Ø³Ù„Ø§Ù…Ø©)
15. [ØªÙƒØ§Ù…Ù„ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†](#ØªÙƒØ§Ù…Ù„-Ø³Ø¬Ù„-Ø§Ù„Ø£Ù…Ø§Ù†)
16. [Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª](#Ø§Ù„Ø£Ø¯ÙˆØ§Ø±-ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª)
17. [ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±](#ØªØµØ¯ÙŠØ±-Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±)
18. [Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª](#Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª)

---

## 1. Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### Route
```
GET /unauthorized
GET /unauthorized/
```

### Function Name
```python
unauthorized_home()
```

### Template Path
```
templates/unauthorized/index.html
```

### Ø§Ù„ÙˆØµÙ
Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Unauthorized Area ØªØ¹Ø±Ø¶ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- **KPIs Ø±Ø¦ÙŠØ³ÙŠØ©:**
  - Ø¹Ø¯Ø¯ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§ Ø§Ù„ÙŠÙˆÙ…
  - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø®Ù„Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
  - Top 5 Hot Zones (Ø£Ø®Ø·Ø± Ø£Ù…Ø§ÙƒÙ†)
  - Top High-Risk Employees (Ø£ÙƒØ«Ø± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø®Ø§Ù„ÙØ©)

- **Violations by Department (Pie Chart):** ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
- **Violations by Location (Heatmap):** Ø®Ø±ÙŠØ·Ø© Ø­Ø±Ø§Ø±ÙŠØ© Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹
- **Trends (Line Chart):** Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª (ÙŠÙˆÙ…ÙŠ/Ø£Ø³Ø¨ÙˆØ¹ÙŠ/Ø´Ù‡Ø±ÙŠ/Ø³Ù†ÙˆÙŠ)
- **Severity Breakdown (Doughnut Chart):** ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·ÙˆØ±Ø© (Low/Medium/High/Critical)

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
2. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
3. **departments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
4. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
5. **violation_types** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.employee_id` â†’ `employees.id`
- `violations.department_id` â†’ `departments.id`
- `violations.location_id` â†’ `locations.id`
- `violations.violation_type_id` â†’ `violation_types.id`
- `employees.department_id` â†’ `departments.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø¹Ø¯Ø¯ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„ÙŠÙˆÙ…
SELECT COUNT(*) as today_violations
FROM violations
WHERE DATE(incident_datetime) = CURRENT_DATE

-- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
SELECT COUNT(*) as monthly_violations
FROM violations
WHERE YEAR(incident_datetime) = YEAR(CURRENT_DATE)
    AND MONTH(incident_datetime) = MONTH(CURRENT_DATE)

-- Top 5 Hot Zones
SELECT 
    l.name as location_name,
    COUNT(v.id) as violation_count
FROM violations v
LEFT JOIN locations l ON v.location_id = l.id
WHERE v.incident_datetime >= DATE('now', '-30 days')
GROUP BY l.id, l.name
ORDER BY violation_count DESC
LIMIT 5

-- Top High-Risk Employees
SELECT 
    e.name as employee_name,
    e.employee_number,
    COUNT(v.id) as violation_count
FROM violations v
LEFT JOIN employees e ON v.employee_id = e.id
WHERE v.incident_datetime >= DATE('now', '-90 days')
GROUP BY e.id, e.name, e.employee_number
ORDER BY violation_count DESC
LIMIT 5

-- Violations by Department (Pie Chart)
SELECT 
    d.name as department_name,
    COUNT(v.id) as violation_count
FROM violations v
LEFT JOIN departments d ON v.department_id = d.id
WHERE v.incident_datetime >= DATE('now', '-30 days')
GROUP BY d.id, d.name
ORDER BY violation_count DESC

-- Violations by Location (Heatmap Data)
SELECT 
    l.name as location_name,
    l.latitude,
    l.longitude,
    COUNT(v.id) as violation_count,
    AVG(CASE 
        WHEN v.severity = 'Critical' THEN 4
        WHEN v.severity = 'High' THEN 3
        WHEN v.severity = 'Medium' THEN 2
        ELSE 1
    END) as avg_severity_score
FROM violations v
LEFT JOIN locations l ON v.location_id = l.id
WHERE v.incident_datetime >= DATE('now', '-30 days')
GROUP BY l.id, l.name, l.latitude, l.longitude

-- Trends (Line Chart) - Daily
SELECT 
    DATE(incident_datetime) as date,
    COUNT(*) as violation_count
FROM violations
WHERE incident_datetime >= DATE('now', '-7 days')
GROUP BY DATE(incident_datetime)
ORDER BY date

-- Severity Breakdown
SELECT 
    severity,
    COUNT(*) as count
FROM violations
WHERE incident_datetime >= DATE('now', '-30 days')
GROUP BY severity
```

---

## 2. Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª

### Route
```
GET /unauthorized/violations
```

### Function Name
```python
unauthorized_violations()
```

### Template Path
```
templates/unauthorized/violations.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø´Ø§Ù…Ù„Ø© ØªØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù‚ÙˆÙŠØ© ÙˆØ¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ ÙƒÙ„ Ø­Ø§Ø¯Ø«.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø¬Ø¯ÙˆÙ„ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ù…Ø¹:
  - Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
  - Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
  - Ø§Ù„Ù…ÙƒØ§Ù†
  - Ø§Ù„Ù‚Ø³Ù…
  - Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
  - Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©
  - Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ø¯Ø« (Open / Under Investigation / Closed)

- **ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨:**
  - Ø§Ù„Ù†ÙˆØ¹
  - Ø§Ù„Ù‚Ø³Ù…
  - Ø§Ù„Ø´Ø®Øµ
  - Ø§Ù„Ù…ÙˆÙ‚Ø¹
  - Ø§Ù„Ø®Ø·ÙˆØ±Ø©
  - Ø§Ù„ØªØ§Ø±ÙŠØ®
  - Ø§Ù„Ø­Ø§Ù„Ø©

- Ø²Ø± "View Incident" Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©

- **ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø§Ø¯Ø«:**
  - ÙˆØµÙ Ø§Ù„Ø­Ø§Ø¯Ø« Ø¨Ø§Ù„ØªÙØµÙŠÙ„
  - Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
  - Ø§Ù„Ø£Ø´Ø®Ø§Øµ Ø§Ù„Ù…ØªÙˆØ±Ø·ÙŠÙ†
  - Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙŠ ØªÙ…Øª
  - Ø³Ø¨Ø¨ Ø§Ù„Ø­Ø§Ø¯Ø« (RCA â€“ Root Cause Analysis)
  - Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ© (Corrective Actions)
  - Manager notes
  - Attachments

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
2. **violation_types** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
3. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
4. **departments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
5. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
6. **violation_attachments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª (ØµÙˆØ±/ÙÙŠØ¯ÙŠÙˆ)
7. **violation_witnesses** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ù‡ÙˆØ¯
8. **corrective_actions** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
9. **investigations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.employee_id` â†’ `employees.id`
- `violations.department_id` â†’ `departments.id`
- `violations.location_id` â†’ `locations.id`
- `violations.violation_type_id` â†’ `violation_types.id`
- `violations.investigation_id` â†’ `investigations.id`
- `violation_attachments.violation_id` â†’ `violations.id`
- `violation_witnesses.violation_id` â†’ `violations.id`
- `violation_witnesses.employee_id` â†’ `employees.id`
- `corrective_actions.violation_id` â†’ `violations.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
SELECT 
    v.*,
    vt.name as violation_type_name,
    e.name as employee_name,
    e.employee_number,
    d.name as department_name,
    l.name as location_name,
    i.status as investigation_status
FROM violations v
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN employees e ON v.employee_id = e.id
LEFT JOIN departments d ON v.department_id = d.id
LEFT JOIN locations l ON v.location_id = l.id
LEFT JOIN investigations i ON v.investigation_id = i.id
ORDER BY v.incident_datetime DESC

-- ØªÙØ§ØµÙŠÙ„ Ø­Ø§Ø¯Ø« Ù…Ø¹ÙŠÙ†
SELECT 
    v.*,
    vt.name as violation_type_name,
    vt.description as violation_type_description,
    e.name as employee_name,
    e.employee_number,
    e.email as employee_email,
    d.name as department_name,
    l.name as location_name,
    l.address as location_address,
    i.id as investigation_id,
    i.status as investigation_status
FROM violations v
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN employees e ON v.employee_id = e.id
LEFT JOIN departments d ON v.department_id = d.id
LEFT JOIN locations l ON v.location_id = l.id
LEFT JOIN investigations i ON v.investigation_id = i.id
WHERE v.id = ?

-- Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø­Ø§Ø¯Ø«
SELECT 
    va.*,
    va.file_path,
    va.file_type,
    va.uploaded_at
FROM violation_attachments va
WHERE va.violation_id = ?
ORDER BY va.uploaded_at

-- Ø§Ù„Ø´Ù‡ÙˆØ¯
SELECT 
    vw.*,
    e.name as witness_name,
    e.employee_number,
    e.email as witness_email
FROM violation_witnesses vw
LEFT JOIN employees e ON vw.employee_id = e.id
WHERE vw.violation_id = ?

-- Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
SELECT 
    ca.*,
    e.name as responsible_name
FROM corrective_actions ca
LEFT JOIN employees e ON ca.responsible_person_id = e.id
WHERE ca.violation_id = ?
ORDER BY ca.created_at
```

---

## 3. Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§

### Route
```
GET /unauthorized/unauthorized-areas
```

### Function Name
```python
unauthorized_areas()
```

### Template Path
```
templates/unauthorized/unauthorized-areas.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ø­Ø¸ÙˆØ± Ø¯Ø®ÙˆÙ„Ù‡Ø§ Ù…Ø¹ ØªÙØ§ØµÙŠÙ„ ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø© ÙˆÙ…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªØµØ±ÙŠØ­.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù…Ø§ÙƒÙ† ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§
- Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªØµØ±ÙŠØ­ Ù„ÙƒÙ„ Ù…ÙƒØ§Ù† (Level 1, 2, 3, etc.)
- Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ù„Ù‡Ù… Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„
- ÙˆÙ‚Øª Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ (Work Permit Times)
- Ø­Ø§Ù„Ø© ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø© (Active / Under Maintenance / Restricted)
- Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ù…Ù†Ø§Ø·Ù‚

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **unauthorized_areas** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§
2. **area_access_levels** - Ø¬Ø¯ÙˆÙ„ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„
3. **area_authorized_employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
4. **work_permits** - Ø¬Ø¯ÙˆÙ„ ØªØµØ§Ø±ÙŠØ­ Ø§Ù„Ø¹Ù…Ù„
5. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
6. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `unauthorized_areas.location_id` â†’ `locations.id`
- `area_authorized_employees.area_id` â†’ `unauthorized_areas.id`
- `area_authorized_employees.employee_id` â†’ `employees.id`
- `area_authorized_employees.access_level_id` â†’ `area_access_levels.id`
- `work_permits.area_id` â†’ `unauthorized_areas.id`
- `work_permits.employee_id` â†’ `employees.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§
SELECT 
    ua.*,
    l.name as location_name,
    l.address,
    COUNT(DISTINCT aae.employee_id) as authorized_employees_count
FROM unauthorized_areas ua
LEFT JOIN locations l ON ua.location_id = l.id
LEFT JOIN area_authorized_employees aae ON ua.id = aae.area_id
WHERE ua.status = 'active'
GROUP BY ua.id
ORDER BY ua.name

-- Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù… Ø¨Ù…Ù†Ø·Ù‚Ø© Ù…Ø¹ÙŠÙ†Ø©
SELECT 
    aae.*,
    e.name as employee_name,
    e.employee_number,
    aal.level_name,
    aal.required_training,
    aal.max_duration_hours
FROM area_authorized_employees aae
LEFT JOIN employees e ON aae.employee_id = e.id
LEFT JOIN area_access_levels aal ON aae.access_level_id = aal.id
WHERE aae.area_id = ?
    AND aae.status = 'active'
ORDER BY e.name

-- ØªØµØ§Ø±ÙŠØ­ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù†Ø´Ø·Ø©
SELECT 
    wp.*,
    ua.name as area_name,
    e.name as employee_name,
    e.employee_number,
    CASE 
        WHEN wp.end_time < CURRENT_TIMESTAMP THEN 'Expired'
        WHEN wp.end_time <= DATETIME('now', '+1 hour') THEN 'Expiring Soon'
        ELSE 'Active'
    END as permit_status
FROM work_permits wp
LEFT JOIN unauthorized_areas ua ON wp.area_id = ua.id
LEFT JOIN employees e ON wp.employee_id = e.id
WHERE wp.status = 'active'
    AND wp.start_time <= CURRENT_TIMESTAMP
    AND wp.end_time >= CURRENT_TIMESTAMP
ORDER BY wp.start_time
```

---

## 4. Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø´Ø®Øµ

### Route
```
GET /unauthorized/violations-by-person
```

### Function Name
```python
unauthorized_violations_by_person()
```

### Template Path
```
templates/unauthorized/violations-by-person.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø·ÙˆØ±Ø© ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø£ÙƒØ«Ø± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ØªØ³Ø¨Ø¨Ù‹Ø§ ÙÙŠ violations
- Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­
- ØªÙ‚ÙŠÙŠÙ… Ø®Ø·ÙˆØ±Ø© Ø§Ù„Ø´Ø®Øµ (Risk Assessment)
- Ù‡Ù„ Ù‡Ùˆ Ø´Ø®Øµ ÙŠØ­ØªØ§Ø¬ ØªØ¯Ø±ÙŠØ¨ Ø¥Ø¶Ø§ÙÙŠØŸ
- Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø´Ø®ØµÙŠ
- Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ø£Ø´Ø®Ø§Øµ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù‚Ø³Ù…
- Trends timeline (Ø®Ø· Ø²Ù…Ù†ÙŠ Ù„Ù„Ù…Ø®Ø§Ù„ÙØ§Øª)

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
2. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
3. **departments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
4. **employee_risk_assessment** - Ø¬Ø¯ÙˆÙ„ ØªÙ‚ÙŠÙŠÙ… Ø®Ø·ÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
5. **training_needs** - Ø¬Ø¯ÙˆÙ„ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.employee_id` â†’ `employees.id`
- `employees.department_id` â†’ `departments.id`
- `employee_risk_assessment.employee_id` â†’ `employees.id`
- `training_needs.employee_id` â†’ `employees.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø£ÙƒØ«Ø± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø®Ø§Ù„ÙØ©
SELECT 
    e.id,
    e.name as employee_name,
    e.employee_number,
    d.name as department_name,
    COUNT(v.id) as total_violations,
    COUNT(CASE WHEN v.severity = 'Critical' THEN 1 END) as critical_count,
    COUNT(CASE WHEN v.severity = 'High' THEN 1 END) as high_count,
    MAX(v.incident_datetime) as last_violation_date
FROM employees e
LEFT JOIN departments d ON e.department_id = d.id
LEFT JOIN violations v ON e.id = v.employee_id
WHERE e.status = 'active'
GROUP BY e.id, e.name, e.employee_number, d.name
HAVING COUNT(v.id) > 0
ORDER BY total_violations DESC
LIMIT 10

-- ØªÙ‚ÙŠÙŠÙ… Ø®Ø·ÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¸Ù
SELECT 
    era.*,
    e.name as employee_name,
    CASE 
        WHEN era.risk_score >= 80 THEN 'Critical'
        WHEN era.risk_score >= 60 THEN 'High'
        WHEN era.risk_score >= 40 THEN 'Medium'
        ELSE 'Low'
    END as risk_level
FROM employee_risk_assessment era
LEFT JOIN employees e ON era.employee_id = e.id
WHERE era.employee_id = ?
ORDER BY era.assessment_date DESC
LIMIT 1

-- Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø´Ø®ØµÙŠ
SELECT 
    v.*,
    vt.name as violation_type_name,
    d.name as department_name,
    l.name as location_name
FROM violations v
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN departments d ON v.department_id = d.id
LEFT JOIN locations l ON v.location_id = l.id
WHERE v.employee_id = ?
ORDER BY v.incident_datetime DESC

-- Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ Ø§Ù„Ù‚Ø³Ù…
SELECT 
    d.name as department_name,
    AVG(emp_violations.violation_count) as avg_violations_per_person,
    COUNT(DISTINCT e.id) as total_employees
FROM departments d
LEFT JOIN employees e ON d.id = e.department_id AND e.status = 'active'
LEFT JOIN (
    SELECT 
        employee_id,
        COUNT(*) as violation_count
    FROM violations
    WHERE incident_datetime >= DATE('now', '-90 days')
    GROUP BY employee_id
) emp_violations ON e.id = emp_violations.employee_id
WHERE d.id = (SELECT department_id FROM employees WHERE id = ?)
GROUP BY d.id, d.name

-- Timeline Ù„Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
SELECT 
    DATE(incident_datetime) as date,
    COUNT(*) as violation_count
FROM violations
WHERE employee_id = ?
    AND incident_datetime >= DATE('now', '-6 months')
GROUP BY DATE(incident_datetime)
ORDER BY date
```

---

## 5. Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…

### Route
```
GET /unauthorized/violations-by-department
```

### Function Name
```python
unauthorized_violations_by_department()
```

### Template Path
```
templates/unauthorized/violations-by-department.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù…Ø¹ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØªØ±ØªÙŠØ¨Ù‡Ø§ Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
- Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ù†ØªØ´Ø§Ø±Ù‹Ø§ ÙÙŠ ÙƒÙ„ Ù‚Ø³Ù…
- Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø´ÙØª (Morning / Night / On-call)
- Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø®Ø·ÙˆØ±Ø©
- Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ø³Ù„Ø§Ù…Ø©
- Recommendations ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù‚Ø³Ù…

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
2. **departments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
3. **violation_types** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
4. **shifts** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª
5. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
6. **department_compliance** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø£Ù‚Ø³Ø§Ù…

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.department_id` â†’ `departments.id`
- `violations.violation_type_id` â†’ `violation_types.id`
- `violations.shift_id` â†’ `shifts.id`
- `employees.department_id` â†’ `departments.id`
- `department_compliance.department_id` â†’ `departments.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø­Ø³Ø¨ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
SELECT 
    d.id,
    d.name as department_name,
    COUNT(v.id) as total_violations,
    COUNT(CASE WHEN v.severity = 'Critical' THEN 1 END) as critical_count,
    COUNT(CASE WHEN v.severity = 'High' THEN 1 END) as high_count,
    COUNT(DISTINCT v.employee_id) as violating_employees_count,
    COUNT(DISTINCT e.id) as total_employees,
    (COUNT(v.id) * 100.0 / COUNT(DISTINCT e.id)) as violations_per_employee
FROM departments d
LEFT JOIN employees e ON d.id = e.department_id AND e.status = 'active'
LEFT JOIN violations v ON d.id = v.department_id
    AND v.incident_datetime >= DATE('now', '-90 days')
GROUP BY d.id, d.name
HAVING COUNT(v.id) > 0
ORDER BY total_violations DESC

-- Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© Ø§Ù„Ø£ÙƒØ«Ø± ÙÙŠ ÙƒÙ„ Ù‚Ø³Ù…
SELECT 
    d.name as department_name,
    vt.name as violation_type_name,
    COUNT(v.id) as violation_count
FROM violations v
LEFT JOIN departments d ON v.department_id = d.id
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
WHERE v.incident_datetime >= DATE('now', '-90 days')
GROUP BY d.id, d.name, vt.id, vt.name
HAVING (d.id, COUNT(v.id)) IN (
    SELECT department_id, MAX(cnt)
    FROM (
        SELECT 
            department_id,
            violation_type_id,
            COUNT(*) as cnt
        FROM violations
        WHERE incident_datetime >= DATE('now', '-90 days')
        GROUP BY department_id, violation_type_id
    )
    GROUP BY department_id
)

-- Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø´ÙØª
SELECT 
    d.name as department_name,
    s.name as shift_name,
    s.shift_type,
    COUNT(v.id) as violation_count
FROM violations v
LEFT JOIN departments d ON v.department_id = d.id
LEFT JOIN shifts s ON v.shift_id = s.id
WHERE v.incident_datetime >= DATE('now', '-30 days')
GROUP BY d.id, d.name, s.id, s.name, s.shift_type
ORDER BY d.name, violation_count DESC

-- Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ø³Ù„Ø§Ù…Ø©
SELECT 
    d.id,
    d.name as department_name,
    dc.compliance_score,
    dc.last_updated,
    CASE 
        WHEN dc.compliance_score >= 90 THEN 'Excellent'
        WHEN dc.compliance_score >= 75 THEN 'Good'
        WHEN dc.compliance_score >= 60 THEN 'Fair'
        ELSE 'Poor'
    END as compliance_level
FROM departments d
LEFT JOIN department_compliance dc ON d.id = dc.department_id
    AND dc.period = DATE('now', 'start of month')
WHERE d.status = 'active'
ORDER BY dc.compliance_score DESC
```

---

## 6. Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹

### Route
```
GET /unauthorized/violations-by-location
```

### Function Name
```python
unauthorized_violations_by_location()
```

### Template Path
```
templates/unauthorized/violations-by-location.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ¹Ø±Ø¶ Ø®Ø±ÙŠØ·Ø© Ø­Ø±Ø§Ø±ÙŠØ© Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª ÙÙŠ ÙƒÙ„ Ù…ÙˆÙ‚Ø¹.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø®Ø±ÙŠØ·Ø© Ø­Ø±Ø§Ø±ÙŠØ© Hot Zones
- Ø£Ù…Ø§ÙƒÙ† ØªØªÙƒØ±Ø± ÙÙŠÙ‡Ø§ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
- Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø© Ù„ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø©
- ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨ÙƒÙ„ Ù…ÙˆÙ‚Ø¹ (Ø¥Ù† ÙˆØ¬Ø¯Øª)
- ØµÙˆØ± ÙˆÙ…Ø±ÙÙ‚Ø§Øª Ø³Ø§Ø¨Ù‚Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø« ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù†

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
2. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
3. **location_cameras** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª
4. **violation_attachments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª
5. **unauthorized_areas** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.location_id` â†’ `locations.id`
- `location_cameras.location_id` â†’ `locations.id`
- `violation_attachments.violation_id` â†’ `violations.id`
- `unauthorized_areas.location_id` â†’ `locations.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø®Ø±ÙŠØ·Ø© Ø­Ø±Ø§Ø±ÙŠØ© Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹
SELECT 
    l.id,
    l.name as location_name,
    l.latitude,
    l.longitude,
    COUNT(v.id) as violation_count,
    COUNT(DISTINCT DATE(v.incident_datetime)) as violation_days,
    AVG(CASE 
        WHEN v.severity = 'Critical' THEN 4
        WHEN v.severity = 'High' THEN 3
        WHEN v.severity = 'Medium' THEN 2
        ELSE 1
    END) as avg_severity_score,
    MAX(v.incident_datetime) as last_violation_date
FROM locations l
LEFT JOIN violations v ON l.id = v.location_id
    AND v.incident_datetime >= DATE('now', '-90 days')
GROUP BY l.id, l.name, l.latitude, l.longitude
ORDER BY violation_count DESC

-- Ø£Ù…Ø§ÙƒÙ† ØªØªÙƒØ±Ø± ÙÙŠÙ‡Ø§ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
SELECT 
    l.name as location_name,
    COUNT(v.id) as violation_count,
    COUNT(DISTINCT v.employee_id) as unique_violators,
    GROUP_CONCAT(DISTINCT vt.name) as violation_types
FROM violations v
LEFT JOIN locations l ON v.location_id = l.id
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
WHERE v.incident_datetime >= DATE('now', '-90 days')
GROUP BY l.id, l.name
HAVING COUNT(v.id) >= 3
ORDER BY violation_count DESC

-- Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
SELECT 
    lc.*,
    l.name as location_name
FROM location_cameras lc
LEFT JOIN locations l ON lc.location_id = l.id
WHERE lc.location_id = ?
    AND lc.status = 'active'

-- Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø­ÙˆØ§Ø¯Ø« ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ù…Ø¹ÙŠÙ†
SELECT 
    va.*,
    v.incident_datetime,
    v.severity
FROM violation_attachments va
LEFT JOIN violations v ON va.violation_id = v.id
WHERE v.location_id = ?
    AND va.file_type IN ('image', 'video')
ORDER BY v.incident_datetime DESC
LIMIT 20
```

---

## 7. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±

### Route
```
GET /unauthorized/risk-analysis
```

### Function Name
```python
unauthorized_risk_analysis()
```

### Template Path
```
templates/unauthorized/risk-analysis.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù… Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ù…Ø¹ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ÙˆØ§Ù„ØªÙˆÙ‚Ø¹Ø§Øª.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- ØªØ­Ù„ÙŠÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ø·Ø±:
  - Unauthorized Entry
  - Unsafe Actions
  - Hazardous Material Access
  - Confined Space Entry
  - Working at Height violations

- Graphs:
  - Bar Chart: ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ø·Ø±
  - Pie Chart: Ù†Ø³Ø¨Ø© ÙƒÙ„ Ù†ÙˆØ¹
  - Line Chart: Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø·Ø±

- ØªÙˆÙ‚Ø¹Ø§Øª AI (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):
  - ØªÙˆÙ‚Ø¹ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„ØªÙŠ Ù‚Ø¯ ØªØ­Ø¯Ø« ÙÙŠÙ‡Ø§ Ù…Ø®Ø§Ù„ÙØ§Øª Ù‚Ø±ÙŠØ¨Ù‹Ø§
  - ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…ØªÙƒØ±Ø±

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
2. **violation_types** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
3. **risk_predictions** - Ø¬Ø¯ÙˆÙ„ ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø·Ø± (AI)
4. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
5. **risk_patterns** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø®Ø§Ø·Ø±

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.violation_type_id` â†’ `violation_types.id`
- `violations.location_id` â†’ `locations.id`
- `risk_predictions.location_id` â†’ `locations.id`
- `risk_predictions.violation_type_id` â†’ `violation_types.id`
- `risk_patterns.violation_type_id` â†’ `violation_types.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- ØªØ­Ù„ÙŠÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ø·Ø±
SELECT 
    vt.id,
    vt.name as risk_type,
    vt.category,
    COUNT(v.id) as violation_count,
    AVG(CASE 
        WHEN v.severity = 'Critical' THEN 4
        WHEN v.severity = 'High' THEN 3
        WHEN v.severity = 'Medium' THEN 2
        ELSE 1
    END) as avg_severity,
    COUNT(DISTINCT v.location_id) as affected_locations,
    COUNT(DISTINCT v.employee_id) as affected_employees
FROM violation_types vt
LEFT JOIN violations v ON vt.id = v.violation_type_id
    AND v.incident_datetime >= DATE('now', '-90 days')
GROUP BY vt.id, vt.name, vt.category
ORDER BY violation_count DESC

-- Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø·Ø± (Line Chart)
SELECT 
    DATE(incident_datetime) as date,
    vt.name as risk_type,
    COUNT(*) as violation_count
FROM violations v
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
WHERE v.incident_datetime >= DATE('now', '-30 days')
GROUP BY DATE(incident_datetime), vt.id, vt.name
ORDER BY date, violation_count DESC

-- ØªÙˆÙ‚Ø¹Ø§Øª AI
SELECT 
    rp.*,
    l.name as location_name,
    vt.name as risk_type_name,
    rp.probability,
    rp.predicted_date
FROM risk_predictions rp
LEFT JOIN locations l ON rp.location_id = l.id
LEFT JOIN violation_types vt ON rp.violation_type_id = vt.id
WHERE rp.status = 'active'
    AND rp.predicted_date >= CURRENT_DATE
ORDER BY rp.probability DESC, rp.predicted_date

-- Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©
SELECT 
    rp.*,
    vt.name as violation_type_name,
    COUNT(DISTINCT v.id) as pattern_occurrences
FROM risk_patterns rp
LEFT JOIN violation_types vt ON rp.violation_type_id = vt.id
LEFT JOIN violations v ON v.violation_type_id = rp.violation_type_id
    AND v.incident_datetime >= DATE('now', '-90 days')
GROUP BY rp.id, rp.pattern_description, vt.name
ORDER BY pattern_occurrences DESC
```

---

## 8. Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ / Ø³Ø¬Ù„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª

### Route
```
GET /unauthorized/daily-log
```

### Function Name
```python
unauthorized_daily_log()
```

### Template Path
```
templates/unauthorized/daily-log.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„ÙŠÙˆÙ…
- ØªØ­Ù„ÙŠÙ„ Ø­Ø³Ø¨ Ø§Ù„Ø´ÙØª
- Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
- Ø´ÙØª Ù…ÙŠÙ† Ø¹Ù…Ù„ Ø£ÙƒØ¨Ø± violations
- ØªÙ‚Ø§Ø±ÙŠØ± PDF ÙŠÙˆÙ…ÙŠØ© Ø¬Ø§Ù‡Ø²Ø©

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
2. **shifts** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª
3. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
4. **daily_reports** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.shift_id` â†’ `shifts.id`
- `violations.employee_id` â†’ `employees.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„ÙŠÙˆÙ…
SELECT 
    COUNT(*) as today_violations,
    COUNT(CASE WHEN severity = 'Critical' THEN 1 END) as critical_count,
    COUNT(CASE WHEN severity = 'High' THEN 1 END) as high_count,
    COUNT(DISTINCT employee_id) as unique_violators,
    COUNT(DISTINCT location_id) as affected_locations
FROM violations
WHERE DATE(incident_datetime) = CURRENT_DATE

-- ØªØ­Ù„ÙŠÙ„ Ø­Ø³Ø¨ Ø§Ù„Ø´ÙØª
SELECT 
    s.name as shift_name,
    s.shift_type,
    COUNT(v.id) as violation_count,
    COUNT(DISTINCT v.employee_id) as unique_violators
FROM violations v
LEFT JOIN shifts s ON v.shift_id = s.id
WHERE DATE(v.incident_datetime) = CURRENT_DATE
GROUP BY s.id, s.name, s.shift_type
ORDER BY violation_count DESC

-- Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
SELECT 
    DATE(incident_datetime) as date,
    COUNT(*) as violation_count,
    COUNT(CASE WHEN severity = 'Critical' THEN 1 END) as critical_count
FROM violations
WHERE incident_datetime >= DATE('now', '-7 days')
GROUP BY DATE(incident_datetime)
ORDER BY date DESC

-- Ø£ÙƒØ«Ø± Ø´ÙØª Ù…Ø®Ø§Ù„ÙØ©
SELECT 
    s.name as shift_name,
    s.shift_type,
    COUNT(v.id) as total_violations,
    AVG(CASE 
        WHEN v.severity = 'Critical' THEN 4
        WHEN v.severity = 'High' THEN 3
        WHEN v.severity = 'Medium' THEN 2
        ELSE 1
    END) as avg_severity
FROM shifts s
LEFT JOIN violations v ON s.id = v.shift_id
    AND v.incident_datetime >= DATE('now', '-30 days')
GROUP BY s.id, s.name, s.shift_type
ORDER BY total_violations DESC
```

---

## 9. Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø«

### Route
```
GET /unauthorized/incident-reporting
```

### Function Name
```python
unauthorized_incident_reporting()
```

### Template Path
```
templates/unauthorized/incident-reporting.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø®Ø§Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- **Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ù…Ø®Ø§Ù„ÙØ©:**
  - Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
  - Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
  - Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹
  - Ø±ÙØ¹ ØµÙˆØ±
  - ØªØ­Ø¯ÙŠØ¯ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©
  - Ø¥Ø¶Ø§ÙØ© ÙˆØµÙ
  - Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø´Ù‡ÙˆØ¯
  - Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø±Ø§Ø¡ ØªØµØ­ÙŠØ­ÙŠ Ø³Ø±ÙŠØ¹

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª (INSERT)
2. **violation_types** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª (SELECT)
3. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (SELECT)
4. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (SELECT)
5. **departments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (SELECT)
6. **violation_attachments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª (INSERT)
7. **violation_witnesses** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ù‡ÙˆØ¯ (INSERT)
8. **corrective_actions** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ© (INSERT)

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `violations.employee_id` â†’ `employees.id`
- `violations.department_id` â†’ `departments.id`
- `violations.location_id` â†’ `locations.id`
- `violations.violation_type_id` â†’ `violation_types.id`
- `violation_attachments.violation_id` â†’ `violations.id`
- `violation_witnesses.violation_id` â†’ `violations.id`
- `violation_witnesses.employee_id` â†’ `employees.id`
- `corrective_actions.violation_id` â†’ `violations.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ù‚Ø§Ø¦Ù…Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª (Ù„Ù„Ù€ Dropdown)
SELECT 
    id,
    name,
    category,
    default_severity
FROM violation_types
WHERE status = 'active'
ORDER BY category, name

-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Ù„Ù„Ù€ Dropdown)
SELECT 
    id,
    name,
    employee_number,
    department_id
FROM employees
WHERE status = 'active'
ORDER BY name

-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (Ù„Ù„Ù€ Dropdown)
SELECT 
    id,
    name,
    address
FROM locations
WHERE status = 'active'
ORDER BY name

-- Ø¥Ø¯Ø±Ø§Ø¬ Ù…Ø®Ø§Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
INSERT INTO violations (
    violation_type_id,
    employee_id,
    department_id,
    location_id,
    incident_datetime,
    severity,
    description,
    reported_by,
    status,
    created_at
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, 'open', CURRENT_TIMESTAMP)

-- Ø¥Ø¯Ø±Ø§Ø¬ Ù…Ø±ÙÙ‚Ø§Øª
INSERT INTO violation_attachments (
    violation_id,
    file_path,
    file_type,
    file_name,
    uploaded_by,
    uploaded_at
) VALUES (?, ?, ?, ?, ?, CURRENT_TIMESTAMP)

-- Ø¥Ø¯Ø±Ø§Ø¬ Ø´Ù‡ÙˆØ¯
INSERT INTO violation_witnesses (
    violation_id,
    employee_id,
    witness_statement,
    added_at
) VALUES (?, ?, ?, CURRENT_TIMESTAMP)

-- Ø¥Ø¯Ø±Ø§Ø¬ Ø¥Ø¬Ø±Ø§Ø¡ ØªØµØ­ÙŠØ­ÙŠ Ø³Ø±ÙŠØ¹
INSERT INTO corrective_actions (
    violation_id,
    action_description,
    responsible_person_id,
    due_date,
    status,
    created_at
) VALUES (?, ?, ?, ?, 'pending', CURRENT_TIMESTAMP)
```

---

## 10. Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª ÙˆØ³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±

### Route
```
GET /unauthorized/investigations
```

### Function Name
```python
unauthorized_investigations()
```

### Template Path
```
templates/unauthorized/investigations.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª ÙÙŠ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ 5 WHY ÙˆØ³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª
- Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ØŸ
- Ù„Ù…Ø§Ø°Ø§ Ø­Ø¯Ø«ØªØŸ (5 WHY Analysis)
- Root Cause
- Ø®Ø·Ø© Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
- ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡
- Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **investigations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª
2. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
3. **investigation_5why** - Ø¬Ø¯ÙˆÙ„ ØªØ­Ù„ÙŠÙ„ 5 WHY
4. **root_causes** - Ø¬Ø¯ÙˆÙ„ Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¬Ø°Ø±
5. **prevention_plans** - Ø¬Ø¯ÙˆÙ„ Ø®Ø·Ø· Ø§Ù„Ù…Ù†Ø¹
6. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `investigations.violation_id` â†’ `violations.id`
- `investigations.investigator_id` â†’ `employees.id`
- `investigations.closed_by` â†’ `employees.id`
- `investigation_5why.investigation_id` â†’ `investigations.id`
- `root_causes.investigation_id` â†’ `investigations.id`
- `prevention_plans.investigation_id` â†’ `investigations.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª
SELECT 
    i.*,
    v.incident_datetime,
    v.severity,
    vt.name as violation_type_name,
    investigator.name as investigator_name,
    closer.name as closer_name
FROM investigations i
LEFT JOIN violations v ON i.violation_id = v.id
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN employees investigator ON i.investigator_id = investigator.id
LEFT JOIN employees closer ON i.closed_by = closer.id
ORDER BY i.created_at DESC

-- ØªØ­Ù„ÙŠÙ„ 5 WHY
SELECT 
    i5w.*,
    i.violation_id
FROM investigation_5why i5w
LEFT JOIN investigations i ON i5w.investigation_id = i.id
WHERE i5w.investigation_id = ?
ORDER BY i5w.why_level

-- Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±
SELECT 
    rc.*,
    i.violation_id
FROM root_causes rc
LEFT JOIN investigations i ON rc.investigation_id = i.id
WHERE rc.investigation_id = ?

-- Ø®Ø·Ø© Ø§Ù„Ù…Ù†Ø¹
SELECT 
    pp.*,
    e.name as responsible_name
FROM prevention_plans pp
LEFT JOIN investigations i ON pp.investigation_id = i.id
LEFT JOIN employees e ON pp.responsible_person_id = e.id
WHERE pp.investigation_id = ?
ORDER BY pp.priority
```

---

## 11. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©

### Route
```
GET /unauthorized/corrective-actions
```

### Function Name
```python
unauthorized_corrective_actions()
```

### Template Path
```
templates/unauthorized/corrective-actions.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ© Ù…Ø¹ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„ØªÙ†ÙÙŠØ°.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
- Ø­Ø§Ù„ØªÙ‡Ø§ (Pending / In progress / Done)
- Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù†Ù‡Ø§
- ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°
- Ù…Ø±ÙÙ‚Ø§Øª
- Ø¹Ù„Ø§Ù…Ø§Øª ØªØ°ÙƒÙŠØ± Reminder Notifications

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **corrective_actions** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
2. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
3. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
4. **corrective_action_attachments** - Ø¬Ø¯ÙˆÙ„ Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
5. **action_reminders** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `corrective_actions.violation_id` â†’ `violations.id`
- `corrective_actions.responsible_person_id` â†’ `employees.id`
- `corrective_action_attachments.action_id` â†’ `corrective_actions.id`
- `action_reminders.action_id` â†’ `corrective_actions.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
SELECT 
    ca.*,
    v.incident_datetime,
    v.severity,
    vt.name as violation_type_name,
    e.name as responsible_name,
    e.email as responsible_email,
    CASE 
        WHEN ca.due_date < CURRENT_DATE AND ca.status != 'completed' THEN 'Overdue'
        WHEN ca.due_date <= DATE('now', '+3 days') AND ca.status != 'completed' THEN 'Due Soon'
        ELSE ca.status
    END as status_with_overdue
FROM corrective_actions ca
LEFT JOIN violations v ON ca.violation_id = v.id
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN employees e ON ca.responsible_person_id = e.id
ORDER BY 
    CASE WHEN ca.due_date < CURRENT_DATE AND ca.status != 'completed' THEN 0 ELSE 1 END,
    ca.due_date ASC

-- Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
SELECT 
    caa.*
FROM corrective_action_attachments caa
WHERE caa.action_id = ?
ORDER BY caa.uploaded_at DESC

-- Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª
SELECT 
    ar.*
FROM action_reminders ar
WHERE ar.action_id = ?
    AND ar.status = 'pending'
ORDER BY ar.reminder_date ASC
```

---

## 12. Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨

### Route
```
GET /unauthorized/training-needs
```

### Function Name
```python
unauthorized_training_needs()
```

### Template Path
```
templates/unauthorized/training-needs.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ù…Ø¹ ØªÙˆØµÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø©.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø®Ø§Ù„ÙØ©
- Ø§Ù„ØªØµØ±ÙŠØ­ Ø¨Ø­Ø¶ÙˆØ± Ø¯ÙˆØ±Ø§Øª Ù…Ø¹ÙŠÙ†Ø© Ù…Ø«Ù„:
  - Authorized area training
  - Confined space training
  - Fire safety
- Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¶ÙˆØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¨
- Ù†Ø³Ø¨Ø© ØªØ­Ø³Ù† Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¯Ø±ÙŠØ¨

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **training_needs** - Ø¬Ø¯ÙˆÙ„ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨
2. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
3. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
4. **training_courses** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ±Ø§Øª
5. **employee_training** - Ø¬Ø¯ÙˆÙ„ Ø³Ø¬Ù„ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
6. **training_effectiveness** - Ø¬Ø¯ÙˆÙ„ ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `training_needs.employee_id` â†’ `employees.id`
- `training_needs.course_id` â†’ `training_courses.id`
- `violations.employee_id` â†’ `employees.id`
- `employee_training.employee_id` â†’ `employees.id`
- `employee_training.course_id` â†’ `training_courses.id`
- `training_effectiveness.employee_id` â†’ `employees.id`
- `training_effectiveness.course_id` â†’ `training_courses.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø®Ø§Ù„ÙØ© (ÙŠØ­ØªØ§Ø¬ÙˆÙ† ØªØ¯Ø±ÙŠØ¨)
SELECT 
    e.id,
    e.name as employee_name,
    e.employee_number,
    COUNT(v.id) as violation_count,
    GROUP_CONCAT(DISTINCT vt.name) as violation_types,
    MAX(v.incident_datetime) as last_violation_date
FROM employees e
LEFT JOIN violations v ON e.id = v.employee_id
    AND v.incident_datetime >= DATE('now', '-90 days')
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
WHERE e.status = 'active'
GROUP BY e.id, e.name, e.employee_number
HAVING COUNT(v.id) >= 2
ORDER BY violation_count DESC

-- Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§
SELECT 
    tn.*,
    e.name as employee_name,
    tc.name as course_name,
    tc.duration,
    tc.category,
    CASE 
        WHEN tn.priority = 'high' THEN 'Critical'
        WHEN tn.priority = 'medium' THEN 'Important'
        ELSE 'Recommended'
    END as priority_level
FROM training_needs tn
LEFT JOIN employees e ON tn.employee_id = e.id
LEFT JOIN training_courses tc ON tn.course_id = tc.id
WHERE tn.status = 'pending'
ORDER BY 
    CASE tn.priority 
        WHEN 'high' THEN 1
        WHEN 'medium' THEN 2
        ELSE 3
    END,
    tn.created_at DESC

-- Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¶ÙˆØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¨
SELECT 
    et.*,
    e.name as employee_name,
    tc.name as course_name,
    tc.category,
    CASE 
        WHEN et.status = 'completed' THEN 'Completed'
        WHEN et.status = 'in_progress' THEN 'In Progress'
        WHEN et.enrollment_date < DATE('now', '-30 days') AND et.status != 'completed' THEN 'Overdue'
        ELSE 'Pending'
    END as training_status
FROM employee_training et
LEFT JOIN employees e ON et.employee_id = e.id
LEFT JOIN training_courses tc ON et.course_id = tc.id
WHERE et.employee_id IN (
    SELECT DISTINCT employee_id 
    FROM violations 
    WHERE incident_datetime >= DATE('now', '-90 days')
)
ORDER BY et.enrollment_date DESC

-- Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ­Ø³Ù† Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
SELECT 
    te.*,
    e.name as employee_name,
    tc.name as course_name,
    COUNT(v_before.id) as violations_before,
    COUNT(v_after.id) as violations_after,
    CASE 
        WHEN COUNT(v_after.id) < COUNT(v_before.id) THEN 'Improved'
        WHEN COUNT(v_after.id) = COUNT(v_before.id) THEN 'No Change'
        ELSE 'Worsened'
    END as improvement_status
FROM training_effectiveness te
LEFT JOIN employees e ON te.employee_id = e.id
LEFT JOIN training_courses tc ON te.course_id = tc.id
LEFT JOIN violations v_before ON e.id = v_before.employee_id
    AND v_before.incident_datetime < te.training_completion_date
    AND v_before.incident_datetime >= DATE(te.training_completion_date, '-90 days')
LEFT JOIN violations v_after ON e.id = v_after.employee_id
    AND v_after.incident_datetime >= te.training_completion_date
    AND v_after.incident_datetime <= DATE(te.training_completion_date, '+90 days')
GROUP BY te.id, te.employee_id, te.course_id, e.name, tc.name
ORDER BY te.training_completion_date DESC
```

---

## 13. Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…

### Route
```
GET /unauthorized/compliance-score
```

### Function Name
```python
unauthorized_compliance_score()
```

### Template Path
```
templates/unauthorized/compliance-score.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© ØªØ¹Ø±Ø¶ Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ù„ÙƒÙ„ Ù‚Ø³Ù… ÙˆÙ…ÙˆÙ‚Ø¹ ÙˆØ´Ø®Øµ Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Score Ù„ÙƒÙ„ Ù‚Ø³Ù…
- Score Ù„ÙƒÙ„ Ù…ÙˆÙ‚Ø¹
- Score Ù„ÙƒÙ„ Ø´Ø®Øµ
- Ø¯ÙˆØ±Ø§Ù† score over time
- ØªØ­Ù„ÙŠÙ„Ø§Øª Ù„ØªØ­Ø³ÙŠÙ† Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù…Ø§Ù†

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **compliance_scores** - Ø¬Ø¯ÙˆÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…
2. **departments** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
3. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
4. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
5. **violations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
6. **compliance_history** - Ø¬Ø¯ÙˆÙ„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `compliance_scores.department_id` â†’ `departments.id`
- `compliance_scores.location_id` â†’ `locations.id`
- `compliance_scores.employee_id` â†’ `employees.id`
- `compliance_history.department_id` â†’ `departments.id`
- `compliance_history.location_id` â†’ `locations.id`
- `compliance_history.employee_id` â†’ `employees.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Score Ù„ÙƒÙ„ Ù‚Ø³Ù…
SELECT 
    d.id,
    d.name as department_name,
    cs.score as current_score,
    cs.last_updated,
    COUNT(v.id) as violation_count,
    AVG(CASE 
        WHEN v.severity = 'Critical' THEN 0
        WHEN v.severity = 'High' THEN 25
        WHEN v.severity = 'Medium' THEN 50
        ELSE 75
    END) as calculated_score
FROM departments d
LEFT JOIN compliance_scores cs ON d.id = cs.department_id
    AND cs.score_type = 'department'
    AND cs.period = DATE('now', 'start of month')
LEFT JOIN violations v ON d.id = v.department_id
    AND v.incident_datetime >= DATE('now', 'start of month')
WHERE d.status = 'active'
GROUP BY d.id, d.name, cs.score, cs.last_updated
ORDER BY cs.score DESC

-- Score Ù„ÙƒÙ„ Ù…ÙˆÙ‚Ø¹
SELECT 
    l.id,
    l.name as location_name,
    cs.score as current_score,
    cs.last_updated,
    COUNT(v.id) as violation_count
FROM locations l
LEFT JOIN compliance_scores cs ON l.id = cs.location_id
    AND cs.score_type = 'location'
    AND cs.period = DATE('now', 'start of month')
LEFT JOIN violations v ON l.id = v.location_id
    AND v.incident_datetime >= DATE('now', 'start of month')
WHERE l.status = 'active'
GROUP BY l.id, l.name, cs.score, cs.last_updated
ORDER BY cs.score DESC

-- Score Ù„ÙƒÙ„ Ø´Ø®Øµ
SELECT 
    e.id,
    e.name as employee_name,
    e.employee_number,
    cs.score as current_score,
    cs.last_updated,
    COUNT(v.id) as violation_count,
    MAX(v.incident_datetime) as last_violation_date
FROM employees e
LEFT JOIN compliance_scores cs ON e.id = cs.employee_id
    AND cs.score_type = 'employee'
    AND cs.period = DATE('now', 'start of month')
LEFT JOIN violations v ON e.id = v.employee_id
    AND v.incident_datetime >= DATE('now', 'start of month')
WHERE e.status = 'active'
GROUP BY e.id, e.name, e.employee_number, cs.score, cs.last_updated
ORDER BY cs.score DESC

-- Ø§ØªØ¬Ø§Ù‡Ø§Øª Score over time
SELECT 
    ch.period,
    ch.score_type,
    ch.score,
    d.name as department_name,
    l.name as location_name,
    e.name as employee_name
FROM compliance_history ch
LEFT JOIN departments d ON ch.department_id = d.id AND ch.score_type = 'department'
LEFT JOIN locations l ON ch.location_id = l.id AND ch.score_type = 'location'
LEFT JOIN employees e ON ch.employee_id = e.id AND ch.score_type = 'employee'
WHERE ch.period >= DATE('now', '-12 months')
ORDER BY ch.period DESC, ch.score_type
```

---

## 14. Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„Ø§Ù…Ø©

### Route
```
GET /unauthorized/policies
```

### Function Name
```python
unauthorized_policies()
```

### Template Path
```
templates/unauthorized/policies.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ù„ÙˆØ§Ø¦Ø­ ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ù…Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©
- Ø§Ù„Ù„ÙˆØ§Ø¦Ø­
- Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©
- ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø©
- ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ©

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **safety_policies** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª
2. **safety_regulations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù„ÙˆØ§Ø¦Ø­
3. **area_safety_instructions** - Ø¬Ø¯ÙˆÙ„ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚
4. **safety_videos** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
5. **unauthorized_areas** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `area_safety_instructions.area_id` â†’ `unauthorized_areas.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª
SELECT 
    sp.*,
    sp.category,
    sp.effective_date,
    sp.last_updated
FROM safety_policies sp
WHERE sp.status = 'active'
ORDER BY sp.category, sp.title

-- Ø§Ù„Ù„ÙˆØ§Ø¦Ø­
SELECT 
    sr.*,
    sr.regulation_number,
    sr.issuing_authority
FROM safety_regulations sr
WHERE sr.status = 'active'
ORDER BY sr.regulation_number

-- ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚
SELECT 
    asi.*,
    ua.name as area_name,
    ua.description
FROM area_safety_instructions asi
LEFT JOIN unauthorized_areas ua ON asi.area_id = ua.id
WHERE asi.status = 'active'
ORDER BY ua.name, asi.priority

-- Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
SELECT 
    sv.*,
    sv.category,
    sv.duration_minutes
FROM safety_videos sv
WHERE sv.status = 'active'
ORDER BY sv.category, sv.title
```

---

## 15. ØªÙƒØ§Ù…Ù„ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†

### Route
```
GET /unauthorized/security-log
```

### Function Name
```python
unauthorized_security_log()
```

### Template Path
```
templates/unauthorized/security-log.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù† Ù…Ø¹ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
- Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø±ÙÙˆØ¶Ø©
- ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±ØªØ¨Ø·Ø©
- Ø¥Ù†Ø°Ø§Ø± Ø¹Ù†Ø¯ Ø¯Ø®ÙˆÙ„ unauthorized person

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **security_logs** - Ø¬Ø¯ÙˆÙ„ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†
2. **access_attempts** - Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„
3. **location_cameras** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª
4. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
5. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
6. **unauthorized_areas** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `security_logs.employee_id` â†’ `employees.id`
- `security_logs.location_id` â†’ `locations.id`
- `access_attempts.employee_id` â†’ `employees.id`
- `access_attempts.area_id` â†’ `unauthorized_areas.id`
- `location_cameras.location_id` â†’ `locations.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
SELECT 
    sl.*,
    e.name as employee_name,
    e.employee_number,
    l.name as location_name,
    CASE 
        WHEN sl.access_granted = 1 THEN 'Granted'
        ELSE 'Denied'
    END as access_status
FROM security_logs sl
LEFT JOIN employees e ON sl.employee_id = e.id
LEFT JOIN locations l ON sl.location_id = l.id
ORDER BY sl.access_time DESC
LIMIT 100

-- Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø±ÙÙˆØ¶Ø©
SELECT 
    aa.*,
    e.name as employee_name,
    e.employee_number,
    ua.name as area_name,
    aa.reason as denial_reason
FROM access_attempts aa
LEFT JOIN employees e ON aa.employee_id = e.id
LEFT JOIN unauthorized_areas ua ON aa.area_id = ua.id
WHERE aa.access_granted = 0
ORDER BY aa.attempt_time DESC
LIMIT 50

-- Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
SELECT 
    lc.*,
    l.name as location_name,
    ua.name as area_name
FROM location_cameras lc
LEFT JOIN locations l ON lc.location_id = l.id
LEFT JOIN unauthorized_areas ua ON lc.area_id = ua.id
WHERE lc.status = 'active'
ORDER BY l.name, lc.camera_name

-- Ø¥Ù†Ø°Ø§Ø±Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­
SELECT 
    aa.*,
    e.name as employee_name,
    e.employee_number,
    ua.name as area_name,
    aa.alert_sent,
    aa.alert_time
FROM access_attempts aa
LEFT JOIN employees e ON aa.employee_id = e.id
LEFT JOIN unauthorized_areas ua ON aa.area_id = ua.id
WHERE aa.access_granted = 0
    AND aa.alert_sent = 1
ORDER BY aa.attempt_time DESC
```

---

## 16. Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

### Route
```
GET /unauthorized/roles-permissions
```

### Function Name
```python
unauthorized_roles_permissions()
```

### Template Path
```
templates/unauthorized/roles-permissions.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø¹ Dashboards Ù…Ø®ØªÙ„ÙØ© Ù„ÙƒÙ„ Ø¯ÙˆØ±.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Manager Dashboard
- HSE Officer Dashboard
- Security Dashboard
- Employee view
- Role-based access

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **user_roles** - Ø¬Ø¯ÙˆÙ„ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
2. **role_permissions** - Ø¬Ø¯ÙˆÙ„ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
3. **permissions** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
4. **users** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
5. **employees** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†

#### Ø§Ù„Ø±ÙŠÙ„ÙŠØ´Ù†Ø²:
- `user_roles.user_id` â†’ `users.id`
- `user_roles.role_id` â†’ `roles.id`
- `role_permissions.role_id` â†’ `roles.id`
- `role_permissions.permission_id` â†’ `permissions.id`
- `users.employee_id` â†’ `employees.id`

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
SELECT 
    ur.*,
    u.username,
    e.name as employee_name,
    r.role_name,
    r.description
FROM user_roles ur
LEFT JOIN users u ON ur.user_id = u.id
LEFT JOIN employees e ON u.employee_id = e.id
LEFT JOIN roles r ON ur.role_id = r.id
WHERE u.status = 'active'
ORDER BY r.role_name, e.name

-- ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¯ÙˆØ±
SELECT 
    rp.*,
    r.role_name,
    p.permission_name,
    p.module,
    p.action
FROM role_permissions rp
LEFT JOIN roles r ON rp.role_id = r.id
LEFT JOIN permissions p ON rp.permission_id = p.id
WHERE r.role_name = ?
ORDER BY p.module, p.action

-- ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
SELECT 
    p.*,
    r.role_name
FROM permissions p
INNER JOIN role_permissions rp ON p.id = rp.permission_id
INNER JOIN user_roles ur ON rp.role_id = ur.role_id
INNER JOIN users u ON ur.user_id = u.id
WHERE u.id = ?
ORDER BY p.module, p.action
```

---

## 17. ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±

### Route
```
GET /unauthorized/reports
```

### Function Name
```python
unauthorized_reports()
```

### Template Path
```
templates/unauthorized/reports.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØµØ¯ÙŠØ±.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- PDF ÙŠÙˆÙ…ÙŠ
- Excel Ø£Ø³Ø¨ÙˆØ¹ÙŠ
- Monthly KPIs
- Violations summary
- Risk Matrix

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ (PDF)
SELECT 
    v.*,
    vt.name as violation_type_name,
    e.name as employee_name,
    d.name as department_name,
    l.name as location_name
FROM violations v
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN employees e ON v.employee_id = e.id
LEFT JOIN departments d ON v.department_id = d.id
LEFT JOIN locations l ON v.location_id = l.id
WHERE DATE(v.incident_datetime) = CURRENT_DATE
ORDER BY v.incident_datetime

-- ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ (Excel)
SELECT 
    DATE(v.incident_datetime) as date,
    COUNT(*) as violation_count,
    COUNT(CASE WHEN v.severity = 'Critical' THEN 1 END) as critical_count,
    COUNT(DISTINCT v.employee_id) as unique_violators,
    COUNT(DISTINCT v.location_id) as affected_locations
FROM violations v
WHERE v.incident_datetime >= DATE('now', '-7 days')
GROUP BY DATE(v.incident_datetime)
ORDER BY date

-- Monthly KPIs
SELECT 
    COUNT(*) as total_violations,
    COUNT(CASE WHEN severity = 'Critical' THEN 1 END) as critical_violations,
    COUNT(DISTINCT employee_id) as unique_violators,
    COUNT(DISTINCT location_id) as affected_locations,
    AVG(CASE 
        WHEN severity = 'Critical' THEN 4
        WHEN severity = 'High' THEN 3
        WHEN severity = 'Medium' THEN 2
        ELSE 1
    END) as avg_severity
FROM violations
WHERE YEAR(incident_datetime) = YEAR(CURRENT_DATE)
    AND MONTH(incident_datetime) = MONTH(CURRENT_DATE)

-- Risk Matrix
SELECT 
    vt.name as risk_type,
    l.name as location_name,
    COUNT(v.id) as occurrence_count,
    AVG(CASE 
        WHEN v.severity = 'Critical' THEN 4
        WHEN v.severity = 'High' THEN 3
        WHEN v.severity = 'Medium' THEN 2
        ELSE 1
    END) as avg_severity,
    (COUNT(v.id) * AVG(CASE 
        WHEN v.severity = 'Critical' THEN 4
        WHEN v.severity = 'High' THEN 3
        WHEN v.severity = 'Medium' THEN 2
        ELSE 1
    END)) as risk_score
FROM violations v
LEFT JOIN violation_types vt ON v.violation_type_id = vt.id
LEFT JOIN locations l ON v.location_id = l.id
WHERE v.incident_datetime >= DATE('now', '-90 days')
GROUP BY vt.id, vt.name, l.id, l.name
ORDER BY risk_score DESC
```

---

## 18. Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª

### Route
```
GET /unauthorized/settings
```

### Function Name
```python
unauthorized_settings()
```

### Template Path
```
templates/unauthorized/settings.html
```

### Ø§Ù„ÙˆØµÙ
ØµÙØ­Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª.

### Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ§Ù‚Ø¹ Ø¬Ø¯ÙŠØ¯Ø©
- Ø¥Ø¶Ø§ÙØ© Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®Ø§Ù„ÙØ§Øª Ø¬Ø¯ÙŠØ¯Ø©
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
- ØªØ®ØµÙŠØµ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª

### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³

#### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. **locations** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (CRUD)
2. **violation_types** - Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª (CRUD)
3. **users** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (CRUD)
4. **roles** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (CRUD)
5. **permissions** - Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (CRUD)
6. **notification_settings** - Ø¬Ø¯ÙˆÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª

#### Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
```sql
-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
SELECT 
    id,
    name,
    address,
    latitude,
    longitude,
    status
FROM locations
ORDER BY name

-- Ù‚Ø§Ø¦Ù…Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
SELECT 
    id,
    name,
    category,
    default_severity,
    description,
    status
FROM violation_types
ORDER BY category, name

-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
SELECT 
    ns.*,
    u.username
FROM notification_settings ns
LEFT JOIN users u ON ns.user_id = u.id
WHERE u.id = ?
```

---

## ğŸ“Š Ù‡ÙŠÙƒÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­

### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:

```sql
-- Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
CREATE TABLE violations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    violation_type_id INTEGER,
    employee_id INTEGER,
    department_id INTEGER,
    location_id INTEGER,
    incident_datetime DATETIME,
    severity TEXT, -- 'Low', 'Medium', 'High', 'Critical'
    description TEXT,
    status TEXT, -- 'open', 'under_investigation', 'closed'
    reported_by INTEGER,
    investigation_id INTEGER,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (violation_type_id) REFERENCES violation_types(id),
    FOREIGN KEY (employee_id) REFERENCES employees(id),
    FOREIGN KEY (department_id) REFERENCES departments(id),
    FOREIGN KEY (location_id) REFERENCES locations(id),
    FOREIGN KEY (reported_by) REFERENCES employees(id),
    FOREIGN KEY (investigation_id) REFERENCES investigations(id)
);

-- Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
CREATE TABLE violation_types (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    category TEXT,
    default_severity TEXT,
    description TEXT,
    status TEXT DEFAULT 'active'
);

-- Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
CREATE TABLE locations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    address TEXT,
    latitude DECIMAL(10,8),
    longitude DECIMAL(11,8),
    status TEXT DEFAULT 'active'
);

-- Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª
CREATE TABLE investigations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    violation_id INTEGER,
    investigator_id INTEGER,
    start_date DATE,
    completion_date DATE,
    status TEXT, -- 'pending', 'in_progress', 'completed', 'closed'
    closed_by INTEGER,
    FOREIGN KEY (violation_id) REFERENCES violations(id),
    FOREIGN KEY (investigator_id) REFERENCES employees(id),
    FOREIGN KEY (closed_by) REFERENCES employees(id)
);

-- Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
CREATE TABLE corrective_actions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    violation_id INTEGER,
    action_description TEXT,
    responsible_person_id INTEGER,
    due_date DATE,
    completion_date DATE,
    status TEXT, -- 'pending', 'in_progress', 'completed'
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (violation_id) REFERENCES violations(id),
    FOREIGN KEY (responsible_person_id) REFERENCES employees(id)
);

-- Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§
CREATE TABLE unauthorized_areas (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    location_id INTEGER,
    description TEXT,
    status TEXT DEFAULT 'active',
    FOREIGN KEY (location_id) REFERENCES locations(id)
);
```

---

## ğŸ” Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

Ø¬Ù…ÙŠØ¹ ØµÙØ­Ø§Øª Unauthorized Area Dashboard ØªØªØ·Ù„Ø¨:
- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (`@login_required`)
- ØµÙ„Ø§Ø­ÙŠØ© Admin ÙÙ‚Ø· (`current_user.username == "admin"`)

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª

- Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ ØªØ¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (Mock Data)
- ÙŠØ¬Ø¨ Ø±Ø¨Ø· Ø§Ù„ØµÙØ­Ø§Øª Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ØªÙ†ÙÙŠØ°
- ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© API endpoints Ù…Ù†ÙØµÙ„Ø© Ù„Ù„Ù€ AJAX calls
- ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Pagination Ù„Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
- ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Search Ùˆ Filtering Ù…ØªÙ‚Ø¯Ù…
- ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Real-time notifications Ù„Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª
- ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Integration Ù…Ø¹ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª

